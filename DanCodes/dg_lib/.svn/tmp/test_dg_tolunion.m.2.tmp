function test_dg_tolUnion

%$Rev$
%$Date$
%$Author$

% col 1 = A, 2 = B, 3 = tol, 4 = output
inout = {
    [1;2;2;3], [2;3;3;4], 0, [1;2;2;2;3;3;3;4]
    [1;2;2;3], [2;3;3;4], 1e-10, [1;2;3;4]
    [1.1;1.21;1.22;1.31], [1.23;1.32;1.33;1.4], 1e-10, ...
        [1.1;1.21;1.22;1.23;1.31;1.32;1.33;1.4]
    [1.1;1.21;1.22;1.31], [1.23;1.32;1.33;1.4], 1.01e-2, ...
        [1.1;1.21;1.31;1.4]
    [1.1;1.21;1.22;1.31], [1.23;1.32;1.33;1.4], 0.069999999999999, ...
        [1.1;1.21;1.31;1.4]
    [1.1;1.21;1.22;1.31], [1.23;1.32;1.33;1.4], 0.07, ...
        [1.1;1.21;1.31]
    [1.1;1.21;1.22;1.31], [1.23;1.32;1.33;1.4], 0.071, ...
        [1.1;1.21;1.31]
    [1.1;1.21;1.22;1.31], [1.23;1.32;1.33;1.4], 0.1, ...
        [1.1;1.21]
    [1.1;1.21;1.22;1.31], [1.23;1.32;1.33;1.4], 1, ...
        [1.1]
    % r=10:
    [1 1;1 21;1 22;1 31], [1 23;1 32;1 33;1 40], 1, ...
        [1 1;1 21;1 22;1 23;1 31;1 32;1 33;1 40]
    [1 1;1 21;1 22;1 31], [1 23;1 32;1 33;1 40], 1.00000000000001, ...
        [1 1;1 21;1 31;1 40]
    [1 1;1 21;1 22;1 31], [1 23;1 32;1 33;1 40], 6.9999999999999, ...
        [1 1;1 21;1 31;1 40]
    [1 1;1 21;1 22;1 31], [1 23;1 32;1 33;1 40], 7, ...
        [1 1;1 21;1 31;1 40]
    [1 1;1 21;1 22;1 31], [1 23;1 32;1 33;1 40], 7.0000000000001, ...
        [1 1;1 21;1 31]
    [1 1;1 21;1 22;1 31], [1 23;1 32;1 33;1 40], 10, ...
        [1 1;1 21]
    [1 1;1 21;1 22;1 31], [1 23;1 32;1 33;1 40], 11, ...
        [1 1;1 21]
    [1 1;1 21;1 22;1 31], [1 23;1 32;1 33;1 40], 20, ...
        [1 1;1 21]
    [1 1;1 21;1 22;1 31], [1 23;1 32;1 33;1 40], 20.000000000001, ...
        [1 1]
    [1 1;2 1;2 2;3 1], [2 3;3 2;3 3;4 0], 1, ...
        [1 1;2 1;2 2;2 3;3 1;3 2;3 3;4 0]
    % r = 20:
    [1 1;2 1;2 2;3 1], [2 3;3 2;3 3;4 0], 1.00000000000001, ...
        [1 1;2 1;3 1;4 0]
    [1 1;1 21;1 22;1 31], [1 23;1 32;1 33;1 40], 7, ...
        [1 1;1 21;1 31;1 40]
    [1 1;1 21;1 22;1 31], [1 23;1 32;1 33;1 40], 10, ...
        [1 1;1 21]
    [1 1;1 21;1 22;1 31], [1 23;1 32;1 33;1 40], Inf, ...
        [1 1]
    [1 1;1 21;2 22;1 31], [3 23;2 32;3 33;1 40], 8.9999999999999, ...
        [1 1;1 21;1 31;1 40;2 22;2 32; 3 23;3 33]
    [1 1;1 21;2 22;1 31], [3 23;2 32;3 33;1 40], 9, ...
        [1 1;1 21;1 31;1 40;2 22;2 32; 3 23;3 33]
    [1 1;1 21;2 22;1 31], [3 23;2 32;3 33;1 40], 10, ...
        [1 1;1 21;1 31;2 22;2 32;3 23;3 33]
    [1 1;1 21;2 22;1 31], [3 23;2 32;3 33;1 40], 10.000000000001, ...
        [1 1;1 21;2 22; 3 23]
    [1 1;1 21;2 22;1 31], [3 23;2 32;3 33;1 40], Inf, ...
        [1 1;2 22; 3 23]
        };

for r = 1: size(inout,1)
    if ~isequal(dg_tolUnion(inout{r,1}, inout{r,2}, inout{r,3}), inout{r,4})
        disp(sprintf('Failed r=%d: dg_tolUnion(%s, %s, %s)', r, ...
            mat2str(inout{r,1}), mat2str(inout{r,2}), mat2str(inout{r,3}) ));
        return
    end
end
disp('Test completed successfully');
